spring:
  application:
    name: egram-platform
  datasource:
    url: jdbc:postgresql://hopper.proxy.rlwy.net:36839/railway?currentSchema=egram_service
    username: ${DB_USERNAME:postgres}
    password: ${DB_PASSWORD:AtVnhUMreDavYkWUDuNHaaLvnMMYFnyM}
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000


  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 10MB

  jpa:
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    hibernate:
      ddl-auto: validate  # Use validate in production, update in development
    properties:
      hibernate:
        format_sql: true
        use_sql_comments: true
        jdbc:
          batch_size: 20
        order_inserts: true
        order_updates: true
        query:
          in_clause_parameter_padding: true
    show-sql: false

  flyway:
    enabled: true
    baseline-on-migrate: true
    locations: classpath:db/migration
    validate-on-migrate: true

server:
    port: 8080

#logging:
#  level:
#    org.hibernate.SQL: DEBUG
#    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
#    com.egram: DEBUG

# Cloud Storage Configuration

cloud:
  storage:
    image:
      max-width: 2560
      max-height: 2560
      max-size-bytes: 10485760 # 10MB
      compression-quality: HIGH # HIGH, MEDIUM, LOW
      target-size-bytes: 102400  # 500KB target

# Cloudflare R2 Configuration
cloudflare:
  r2:
    enabled: ${CLOUDFLARE_R2_ENABLED:true}
    # Account ID from Cloudflare Dashboard > R2 > Overview
    account-id: ${CLOUDFLARE_R2_ACCOUNT_ID:}
    # Access Key ID and Secret from Cloudflare Dashboard > R2 > Manage R2 API Tokens
    access-key-id: ${CLOUDFLARE_R2_ACCESS_KEY_ID:}
    secret-access-key: ${CLOUDFLARE_R2_SECRET_ACCESS_KEY:}
    # Bucket name
    bucket-name: ${CLOUDFLARE_R2_BUCKET_NAME:egram}
    # Optional: Custom endpoint (if not provided, will use: https://<account-id>.r2.cloudflarestorage.com)
    endpoint: ${CLOUDFLARE_R2_ENDPOINT:}
    public-domain: ${CLOUDFLARE_R2_PUBLIC_DOMAIN:}

# Google OAuth Configuration
google:
  oauth:
    client-id: ${GOOGLE_CLIENT_ID:}
    client-secret: ${GOOGLE_CLIENT_SECRET:}
    redirect-uri: ${GOOGLE_REDIRECT_URI:${BASE_URL:http://localhost:8080}/api/v1/auth/google/callback}
    encryption-key: ${GOOGLE_ENCRYPTION_KEY:} # Base64 encoded 256-bit AES key
    frontend-url: ${FRONTEND_URL:http://localhost:5173} # Frontend URL for OAuth redirects
  drive:
    scope: https://www.googleapis.com/auth/drive.file

# Document Configuration
document:
  allowed-types: application/pdf,image/jpeg,image/png,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
  max-size-mb: 10

## Custom path for OpenAPI documentation
#springdoc:
#  api-docs:
#    path: /api-docs
#  swagger-ui:
#    path: /swagger-ui.html