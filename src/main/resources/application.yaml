spring:
  application:
    name: egram-platform
  datasource:
    url: jdbc:postgresql://hopper.proxy.rlwy.net:36839/railway?currentSchema=egram_service
    username: ${DB_USERNAME:postgres}
    password: ${DB_PASSWORD:AtVnhUMreDavYkWUDuNHaaLvnMMYFnyM}
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000


  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 10MB

  jpa:
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    hibernate:
      ddl-auto: validate  # Use validate in production, update in development
    properties:
      hibernate:
        format_sql: true
        use_sql_comments: true
        jdbc:
          batch_size: 20
        order_inserts: true
        order_updates: true
        query:
          in_clause_parameter_padding: true
    show-sql: false

  flyway:
    enabled: true
    baseline-on-migrate: true
    locations: classpath:db/migration
    validate-on-migrate: true

server:
    port: 8082

#logging:
#  level:
#    org.hibernate.SQL: DEBUG
#    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
#    com.egram: DEBUG

# Cloud Storage Configuration
cloud:
  storage:
    image:
      max-width: 2560
      max-height: 2560
      max-size-bytes: 10485760 # 10MB
      compression-quality: HIGH # HIGH, MEDIUM, LOW
      target-size-bytes: 512000 # 500KB target

# Backblaze B2 Configuration
backblaze:
  b2:
    enabled: ${BACKBLAZE_ENABLED:true}
    app-key-id: ${BACKBLAZE_APP_KEY_ID:0057a65c2d160d00000000001}
    app-key: ${BACKBLAZE_APP_KEY:K005Z5WOjx8SCcSvkR4UrJ0qLpLaGXg}
    bucket-name: ${BACKBLAZE_BUCKET_NAME:egraamseva}
    bucket-id: ${BACKBLAZE_BUCKET_ID:272ab6351ce2ed5196a00d10}
    base-url: ${BACKBLAZE_BASE_URL:https://f001.backblazeb2.com}
    s3-endpoint: ${BACKBLAZE_S3_ENDPOINT:https://s3.us-east-005.backblazeb2.com}
    s3-region: ${BACKBLAZE_S3_REGION:us-east-005}
    # S3-compatible API credentials - generate from Backblaze B2 > Account Settings > App Keys
    # Create an "Application Key" with S3-compatible access
    s3-access-key: ${BACKBLAZE_S3_ACCESS_KEY:0057a65c2d160d00000000001}
    s3-secret-key: ${BACKBLAZE_S3_SECRET_KEY:K005Z5WOjx8SCcSvkR4UrJ0qLpLaGXg}
    presigned-url-expiration-hours: ${BACKBLAZE_PRESIGNED_URL_EXPIRATION_HOURS:168} # 7 days (168 hours)

## Custom path for OpenAPI documentation
#springdoc:
#  api-docs:
#    path: /api-docs
#  swagger-ui:
#    path: /swagger-ui.html