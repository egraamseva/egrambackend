spring:
  application:
    name: egram-platform
  datasource:
    url: jdbc:postgresql://hopper.proxy.rlwy.net:36839/railway?currentSchema=egram_service
    username: ${DB_USERNAME:postgres}
    password: ${DB_PASSWORD:AtVnhUMreDavYkWUDuNHaaLvnMMYFnyM}
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000


  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 10MB

  jpa:
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    hibernate:
      ddl-auto: validate  # Use validate in production, update in development
    properties:
      hibernate:
        format_sql: true
        use_sql_comments: true
        jdbc:
          batch_size: 20
        order_inserts: true
        order_updates: true
        query:
          in_clause_parameter_padding: true
    show-sql: false

  flyway:
    enabled: false
    baseline-on-migrate: true
    locations: classpath:db/migration
    validate-on-migrate: true

server:
    port: 8080

#logging:
#  level:
#    org.hibernate.SQL: DEBUG
#    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
#    com.egram: DEBUG

# Cloud Storage Configuration

cloud:
  storage:
    image:
      max-width: 2560
      max-height: 2560
      max-size-bytes: 10485760 # 10MB
      compression-quality: HIGH # HIGH, MEDIUM, LOW
      target-size-bytes: 102400  # 500KB target

# Cloudflare R2 Configuration
cloudflare:
  r2:
    enabled: ${CLOUDFLARE_R2_ENABLED:true}
    # Account ID from Cloudflare Dashboard > R2 > Overview
    account-id: ${CLOUDFLARE_R2_ACCOUNT_ID:72388a38a4a793a92ddc8014902a3c19}
    # Access Key ID and Secret from Cloudflare Dashboard > R2 > Manage R2 API Tokens
    access-key-id: ${CLOUDFLARE_R2_ACCESS_KEY_ID:588f23e2205e0e04da53b95df518fb32}
    secret-access-key: ${CLOUDFLARE_R2_SECRET_ACCESS_KEY:f77319d270c2b2137f3cebd1c15ab82f1b8cc48bdcc2b1e24208aecc0678cfdd}
    # Bucket name
    bucket-name: ${CLOUDFLARE_R2_BUCKET_NAME:egram}
    # Optional: Custom endpoint (if not provided, will use: https://<account-id>.r2.cloudflarestorage.com)
    endpoint: ${CLOUDFLARE_R2_ENDPOINT:}
    # REQUIRED: Public domain for the bucket (R2 Custom Domain or R2.dev subdomain)
    # Examples:
    #   - https://pub-xxxxx.r2.dev (R2.dev subdomain)
    #   - https://cdn.yourdomain.com (Custom domain)
    # To set up:
    #   1. Go to R2 Dashboard > Select your bucket > Settings
    #   2. Under "Public Access", click "Allow Access" or "Connect Domain"
    #   3. Use the R2.dev URL or configure a custom domain
    public-domain: ${CLOUDFLARE_R2_PUBLIC_DOMAIN:https://pub-9d96ad7cc28648fa87573d5fd13292b1.r2.dev}
## Custom path for OpenAPI documentation
#springdoc:
#  api-docs:
#    path: /api-docs
#  swagger-ui:
#    path: /swagger-ui.html